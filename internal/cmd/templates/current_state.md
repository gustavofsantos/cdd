# Survey: <Target Module/Feature Name>
> **Generated by:** cdd-surveyor
> **Objective:** Map legacy complexity and define the testing strategy before changes begin.

## 1. The Blast Radius
*Identify the files and components that will likely change or be impacted.*

| Component/File | Type | Responsibility |
| :--- | :--- | :--- |
| `src/core/pricing.clj` | Logic | Main tax calculation engine |
| `src/db/queries.sql` | Data | Fetches user tax bracket |
| `src/api/handler.go` | Entry | HTTP endpoint for checkout |

## 2. Complexity & Coupling
*Analyze the "Dragons" in the code.*

* **Global State:** [e.g. Relies on a global `CONFIG` singleton? Database connection?]
* **External Dependencies:** [e.g. Calls Stripe API? Reads from S3?]
* **Hard Logic:** [e.g. Nested `if/else` depth > 3? Regex magic?]
* **Side Effects:** [e.g. Sends emails? Writes to disk?]

## 3. Testability Strategy (Crucial)
*Determine how we will verify behavior without breaking legacy logic.*

### Assessment
- [ ] **Unit Testable:** Code is pure or easily mocked.
- [ ] **Golden Master Candidate:** Code is coupled/complex; we need to capture output snapshots.
- [ ] **Untestable:** Manual verification required (High Risk).

### üõ°Ô∏è The Harness Plan
*(Fill this if Golden Master or Unit Testable is checked)*

* **Entry Point:** `[Function name or API Endpoint]`
* **Input Data Source:** `[e.g., "Use 5 JSON files from prod logs" or "Seed local DB"]`
* **Capture Mechanism:** `[e.g., "Capture STDOUT", "Capture HTTP Response Body", "Capture DB Row State"]`
* **Mocking Needs:** `[What *must* be fake? e.g., "Mock the EmailService to avoid spamming"]`

## 4. Current Logic Flow (Mental Model)
*Briefly describe the current sequence of events to ground the Analyst.*

1.  Input arrives via...
2.  System validates...
3.  Calculations performed...
4.  Data persisted to...

## 5. Artifacts & References
* **Existing Tests:** `[Path to any relevant existing tests]`
* **Documentation:** `[Links to old docs or relevant tickets]`
